
          =============================================================
          Num trainable parameters
          536577
          ==============================================================

starting launch round 0
[2m[36m(PoolActor pid=1217)[0m /home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/torch/jit/annotations.py:310: UserWarning: TorchScript will treat type annotations of Tensor dtype-specific subtypes as if they are normal Tensors. dtype constraints are not enforced in compilation either.
[2m[36m(PoolActor pid=1217)[0m   warnings.warn("TorchScript will treat type annotations of Tensor "
[2m[36m(PoolActor pid=1218)[0m original problem has 5928 variables (5852 bin, 76 int, 0 impl, 0 cont) and 5930 constraints
[2m[36m(PoolActor pid=1219)[0m
[2m[36m(PoolActor pid=1219)[0m     ================================================
[2m[36m(PoolActor pid=1219)[0m     Problemname: TSP 14:12:34 236
[2m[36m(PoolActor pid=1219)[0m            Baseline               NN
[2m[36m(PoolActor pid=1219)[0m     GAP   0.7202739713025973    0.6201501634555531
[2m[36m(PoolActor pid=1219)[0m     Nodes -1    237
[2m[36m(PoolActor pid=1219)[0m     ================================================
[2m[36m(PoolActor pid=1219)[0m
[2m[36m(PoolActor pid=1216)[0m original problem has 5624 variables (5550 bin, 74 int, 0 impl, 0 cont) and 5626 constraints[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[2m[36m(PoolActor pid=1218)[0m done converting, starting to send to main process
updated 19 from value 0.6111580567427899 to value 0.5246966722997207
updated 59 from value 0.7202739713025973 to value 0.6201501634555531
updated 107 from value 0.9003570886574356 to value 0.36693017476834566
0 rewards: [-0.0036916190292686224, 0.14147141575813293, -0.12500357627868652, -0.0014186997432261705, -0.1772608458995819, 0.13900795578956604, 0.5924615263938904, -0.13197699189186096]
getting old model base
fitting....
loss 0.010497171431779861: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 16/16 [00:53<00:00,  3.31s/it]
old_vs tensor(-0.5149) vs tensor(-0.5149, grad_fn=<MeanBackward0>) logratio tensor(1., grad_fn=<MeanBackward0>) Â± tensor(0., grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5189) vs tensor(-0.4923, grad_fn=<MeanBackward0>) logratio tensor(1.0000, grad_fn=<MeanBackward0>) Â± tensor(0.0010, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4874) vs tensor(-0.4390, grad_fn=<MeanBackward0>) logratio tensor(1.0000, grad_fn=<MeanBackward0>) Â± tensor(0.0017, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4868) vs tensor(-0.4164, grad_fn=<MeanBackward0>) logratio tensor(1.0000, grad_fn=<MeanBackward0>) Â± tensor(0.0016, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4758) vs tensor(-0.3967, grad_fn=<MeanBackward0>) logratio tensor(1.0001, grad_fn=<MeanBackward0>) Â± tensor(0.0017, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4734) vs tensor(-0.3736, grad_fn=<MeanBackward0>) logratio tensor(1.0004, grad_fn=<MeanBackward0>) Â± tensor(0.0019, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5008) vs tensor(-0.3676, grad_fn=<MeanBackward0>) logratio tensor(1.0001, grad_fn=<MeanBackward0>) Â± tensor(0.0026, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4964) vs tensor(-0.3604, grad_fn=<MeanBackward0>) logratio tensor(1.0003, grad_fn=<MeanBackward0>) Â± tensor(0.0027, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5011) vs tensor(-0.3357, grad_fn=<MeanBackward0>) logratio tensor(1.0000, grad_fn=<MeanBackward0>) Â± tensor(0.0028, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5039) vs tensor(-0.2914, grad_fn=<MeanBackward0>) logratio tensor(0.9996, grad_fn=<MeanBackward0>) Â± tensor(0.0032, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4964) vs tensor(-0.2833, grad_fn=<MeanBackward0>) logratio tensor(0.9995, grad_fn=<MeanBackward0>) Â± tensor(0.0039, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5010) vs tensor(-0.2801, grad_fn=<MeanBackward0>) logratio tensor(1.0000, grad_fn=<MeanBackward0>) Â± tensor(0.0037, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5110) vs tensor(-0.2554, grad_fn=<MeanBackward0>) logratio tensor(1.0005, grad_fn=<MeanBackward0>) Â± tensor(0.0039, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.4956) vs tensor(-0.2233, grad_fn=<MeanBackward0>) logratio tensor(0.9993, grad_fn=<MeanBackward0>) Â± tensor(0.0058, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5092) vs tensor(-0.2318, grad_fn=<MeanBackward0>) logratio tensor(1.0001, grad_fn=<MeanBackward0>) Â± tensor(0.0043, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
old_vs tensor(-0.5106) vs tensor(-0.2021, grad_fn=<MeanBackward0>) logratio tensor(1.0006, grad_fn=<MeanBackward0>) Â± tensor(0.0046, grad_fn=<StdBackward0>) torch.Size([128]) torch.Size([128])
RUNNING 0
RUNNING 1
RUNNING 2
RUNNING 3
RUNNING 4
RUNNING 5
RUNNING 6
RUNNING 7
[2m[36m(PoolActor pid=1216)[0m     [32m [repeated 14x across cluster][0m
[2m[36m(PoolActor pid=1216)[0m     ================================================[32m [repeated 14x across cluster][0m
[2m[36m(PoolActor pid=1216)[0m     Problemname: TSP 14:12:34 232[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1216)[0m            Baseline               NN[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1216)[0m     GAP   0.525141319289568    0.5907858772878442[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1216)[0m     Nodes -1    234[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1215)[0m original problem has 6083 variables (6006 bin, 77 int, 0 impl, 0 cont) and 6085 constraints
[2m[36m(PoolActor pid=1215)[0m done converting, starting to send to main process[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m original problem has 7224 variables (7140 bin, 84 int, 0 impl, 0 cont) and 7226 constraints
[2m[36m(PoolActor pid=1218)[0m     [32m [repeated 2x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m     ================================================[32m [repeated 2x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m     Problemname: TSP 14:14:21 195
[2m[36m(PoolActor pid=1218)[0m            Baseline               NN
[2m[36m(PoolActor pid=1218)[0m     GAP   0.7198909426231288    0.548972449182676
[2m[36m(PoolActor pid=1218)[0m     Nodes -1    196
[2m[36m(PoolActor pid=1216)[0m original problem has 6083 variables (6006 bin, 77 int, 0 impl, 0 cont) and 6085 constraints[32m [repeated 6x across cluster][0m
[2m[36m(PoolActor pid=1214)[0m     Problemname: TSP 14:14:21 168
[2m[36m(PoolActor pid=1214)[0m            Baseline               NN
[2m[36m(PoolActor pid=1214)[0m     GAP   0.6738435269401509    0.6552977093796495
[2m[36m(PoolActor pid=1214)[0m     Nodes -1    169
[2m[36m(PoolActor pid=1214)[0m done converting, starting to send to main process
RUNNING 8
RUNNING 9
RUNNING 10
RUNNING 11
RUNNING 12
RUNNING 13
RUNNING 14
RUNNING 15
[2m[36m(PoolActor pid=1218)[0m     [32m [repeated 16x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m     ================================================[32m [repeated 16x across cluster][0m
[2m[36m(PoolActor pid=1216)[0m original problem has 6723 variables (6642 bin, 81 int, 0 impl, 0 cont) and 6725 constraints[32m [repeated 8x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m     Problemname: TSP 14:15:08 302[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m            Baseline               NN[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m     GAP   0.7648774637330624    0.742528420024493[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1218)[0m     Nodes -1    255[32m [repeated 7x across cluster][0m
[2m[36m(PoolActor pid=1217)[0m done converting, starting to send to main process[32m [repeated 7x across cluster][0m
RUNNING 16
RUNNING 17
RUNNING 18
RUNNING 19
RUNNING 20
RUNNING 21
RUNNING 22
RUNNING 23
Traceback (most recent call last):
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 239, in <module>
    main()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 236, in main
    train(cfg,NN, optim)
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 212, in train
    eval_model(pool,NN, df_eval)
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 116, in eval_model
    d = pool.starmap(__make_and_optimize,args)
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/ray/util/multiprocessing/pool.py", line 891, in starmap
    ).get()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/ray/util/multiprocessing/pool.py", line 343, in get
    self.wait(timeout)
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/ray/util/multiprocessing/pool.py", line 340, in wait
    self._result_thread.join(timeout)
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 239, in <module>
    main()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 236, in main
    train(cfg,NN, optim)
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 212, in train
    eval_model(pool,NN, df_eval)
  File "/home/xuziqiang/BranchAndBoundBisim-object-free-model/main.py", line 116, in eval_model
    d = pool.starmap(__make_and_optimize,args)
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/ray/util/multiprocessing/pool.py", line 891, in starmap
    ).get()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/ray/util/multiprocessing/pool.py", line 343, in get
    self.wait(timeout)
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/site-packages/ray/util/multiprocessing/pool.py", line 340, in wait
    self._result_thread.join(timeout)
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/home/xuziqiang/miniconda3/envs/BnBbisim/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt
